{"ast":null,"code":"import _objectSpread from\"C:/Users/Acer/Documents/Kazi_Connect/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import axiosInstance from'../utils/axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PostTask=()=>{const navigate=useNavigate();const[loading,setLoading]=useState(true);const[formData,setFormData]=useState({title:'',description:'',price:'',location:'',skills:''});const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};useEffect(()=>{const verifyAccess=async()=>{try{const{data}=await axiosInstance.get('/auth/me');if(data.role!=='client'){toast.error('Only clients can post tasks');navigate('/dashboard');return;}}catch(err){console.error('Access verification failed:',err);}finally{setLoading(false);}};verifyAccess();},[navigate]);const handleSubmit=async e=>{e.preventDefault();try{await axiosInstance.post('/tasks',_objectSpread(_objectSpread({},formData),{},{skills:formData.skills?formData.skills.split(',').map(s=>s.trim()):[]}));toast.success('Task posted successfully!');navigate('/dashboard');}catch(err){// Error toast is handled by axios interceptor\nconsole.error('Task post error:',err);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"Post a Task\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"max-w-lg mx-auto bg-white shadow-lg rounded-lg p-6 border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"title\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",placeholder:\"Task Title\",onChange:handleChange,className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"description\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"description\",placeholder:\"Task Description\",onChange:handleChange,className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",rows:\"4\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"price\",children:\"Price (KSh)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"price\",placeholder:\"Price in Kenyan Shillings\",onChange:handleChange,className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"location\",children:\"Location\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"location\",placeholder:\"Task Location\",onChange:handleChange,className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"skills\",children:\"Required Skills\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"skills\",placeholder:\"Skills (comma separated, e.g., plumbing, electrical)\",onChange:handleChange,className:\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300\",children:\"Post Task\"})]})]});};export default PostTask;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","toast","axiosInstance","jsx","_jsx","jsxs","_jsxs","PostTask","navigate","loading","setLoading","formData","setFormData","title","description","price","location","skills","handleChange","e","_objectSpread","target","name","value","verifyAccess","data","get","role","error","err","console","handleSubmit","preventDefault","post","split","map","s","trim","success","className","children","onSubmit","htmlFor","type","placeholder","onChange","required","rows"],"sources":["C:/Users/Acer/Documents/Kazi_Connect/frontend/src/pages/PostTask.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport axiosInstance from '../utils/axios';\r\n\r\nconst PostTask = () => {\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    description: '',\r\n    price: '',\r\n    location: '',\r\n    skills: ''\r\n  });\r\n\r\n  const handleChange = (e) => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const verifyAccess = async () => {\r\n      try {\r\n        const { data } = await axiosInstance.get('/auth/me');\r\n        if (data.role !== 'client') {\r\n          toast.error('Only clients can post tasks');\r\n          navigate('/dashboard');\r\n          return;\r\n        }\r\n      } catch (err) {\r\n        console.error('Access verification failed:', err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    verifyAccess();\r\n  }, [navigate]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      await axiosInstance.post('/tasks', {\r\n        ...formData,\r\n        skills: formData.skills ? formData.skills.split(',').map(s => s.trim()) : []\r\n      });\r\n      toast.success('Task posted successfully!');\r\n      navigate('/dashboard');\r\n    } catch (err) {\r\n      // Error toast is handled by axios interceptor\r\n      console.error('Task post error:', err);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-screen\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-8\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Post a Task</h2>\r\n      <form onSubmit={handleSubmit} className=\"max-w-lg mx-auto bg-white shadow-lg rounded-lg p-6 border\">\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"title\">Title</label>\r\n          <input type=\"text\" name=\"title\" placeholder=\"Task Title\" onChange={handleChange} className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"description\">Description</label>\r\n          <textarea name=\"description\" placeholder=\"Task Description\" onChange={handleChange} className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" rows=\"4\" required />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"price\">Price (KSh)</label>\r\n          <input type=\"number\" name=\"price\" placeholder=\"Price in Kenyan Shillings\" onChange={handleChange} className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\r\n        </div>\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"location\">Location</label>\r\n          <input type=\"text\" name=\"location\" placeholder=\"Task Location\" onChange={handleChange} className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" required />\r\n        </div>\r\n        <div className=\"mb-6\">\r\n          <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"skills\">Required Skills</label>\r\n          <input type=\"text\" name=\"skills\" placeholder=\"Skills (comma separated, e.g., plumbing, electrical)\" onChange={handleChange} className=\"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n        </div>\r\n        <button type=\"submit\" className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300\">Post Task</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostTask;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}